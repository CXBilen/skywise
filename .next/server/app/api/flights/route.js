(()=>{var e={};e.id=907,e.ids=[907],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},1550:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>y,routeModule:()=>U,serverHooks:()=>C,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>b});var r={};s.r(r),s.d(r,{GET:()=>N,POST:()=>R,PUT:()=>A});var a=s(2706),o=s(8203),n=s(5994),i=s(9187);let l=new Set(["JFK","LGA","EWR","LAX","SFO","ORD","DFW","DEN","SEA","MIA","BOS","ATL","PHX","IAH","LAS","MCO","MSP","DTW","PHL","CLT","LHR","CDG","NRT","HND","IST","SAW","DXB","SIN","HKG","AMS","FRA","MUC","MAD","BCN","FCO","SYD","YYZ","MEX","GRU","ICN"]),u=new Set(["JFK-PRG"]);function c(e,t){return{code:e,...{NO_FLIGHTS_FOUND:{message:t||"No flights found for this route and date combination.",suggestions:["Try searching for nearby airports","Check flights on adjacent dates","Consider flights with connections"],retryable:!0},INVALID_ROUTE:{message:t||"The specified route is not valid or not currently served.",suggestions:["Verify the airport codes are correct","Check if the route requires a connection","Try searching for alternative airports"],retryable:!1},DATE_UNAVAILABLE:{message:t||"Flights are not available for the selected date.",suggestions:["Airlines typically open bookings 330 days in advance","Try a date closer to today","Check if the airline operates on this day of the week"],retryable:!0},DATE_IN_PAST:{message:t||"The selected date is in the past.",suggestions:["Please select a future date","Consider booking for tomorrow or later"],retryable:!1},SERVICE_ERROR:{message:t||"Unable to connect to flight search service.",suggestions:["Please try again in a moment","Check your internet connection"],retryable:!0},CALENDAR_ERROR:{message:t||"Unable to check calendar availability.",suggestions:[],retryable:!0},EMAIL_PARSE_ERROR:{message:t||"Unable to parse email content.",suggestions:[],retryable:!1},BOOKING_FAILED:{message:t||"Unable to complete booking.",suggestions:["The flight may no longer be available","Try searching for updated options"],retryable:!0},CONFLICT_UNRESOLVED:{message:t||"Calendar conflict must be resolved.",suggestions:[],retryable:!1},UNKNOWN_ERROR:{message:t||"An unexpected error occurred.",suggestions:["Please try again","Start a new search if the problem persists"],retryable:!0}}[e]}}function p(e){return l.has(e.toUpperCase())}function d(e){let t=new Date(e),s=new Date;if(s.setHours(0,0,0,0),isNaN(t.getTime()))return{valid:!1,error:"DATE_UNAVAILABLE"};if(t<s)return{valid:!1,error:"DATE_IN_PAST"};let r=new Date(s);return(r.setDate(r.getDate()+330),t>r)?{valid:!1,error:"DATE_UNAVAILABLE"}:{valid:!0}}function g(e,t){if(!p(e)||!p(t)||e.toUpperCase()===t.toUpperCase())return{valid:!1,error:"INVALID_ROUTE"};let s=`${e.toUpperCase()}-${t.toUpperCase()}`;return u.has(s)?{valid:!1,error:"NO_FLIGHTS_FOUND"}:{valid:!0}}let h=[{name:"United",code:"UA",logo:"✈️"},{name:"American",code:"AA",logo:"\uD83D\uDEEB"},{name:"Delta",code:"DL",logo:"\uD83D\uDD3A"},{name:"JetBlue",code:"B6",logo:"\uD83D\uDC99"},{name:"Southwest",code:"WN",logo:"❤️"},{name:"Alaska",code:"AS",logo:"\uD83C\uDFD4️"}],f=[{departure:"06:00",arrival:"09:15",label:"early_morning"},{departure:"08:30",arrival:"11:45",label:"morning"},{departure:"11:30",arrival:"14:45",label:"midday"},{departure:"14:15",arrival:"17:30",label:"afternoon"},{departure:"17:00",arrival:"20:15",label:"evening"},{departure:"20:30",arrival:"23:45",label:"night"}];function m(e,t,s,r=4){return .05>Math.random()?[]:f.slice(0,r).map((s,r)=>{let a=h[r%h.length],o=`${a.code}${100+Math.floor(900*Math.random())}`,n=Math.floor(180+150*Math.random()),i=Math.random()>.7?1:0,l=315+90*i+Math.floor(60*Math.random()),u=["fits","fits","fits","conflict","pending"],c=u[Math.floor(Math.random()*u.length)];return{id:`flight_${Date.now()}_${r}`,airline:a.name,airlineLogo:a.logo,flightNumber:o,departureTime:s.departure,arrivalTime:s.arrival,origin:e.toUpperCase(),originCode:e.toUpperCase(),destination:t.toUpperCase(),destinationCode:t.toUpperCase(),duration:`${Math.floor(l/60)}h ${l%60}m`,durationMinutes:l,stops:i,stopLocations:i>0?["DEN"]:void 0,price:n,class:"economy",calendarFit:c,availableSeats:5+Math.floor(50*Math.random()),aircraft:"Boeing 737-800"}})}async function N(e){try{let{searchParams:t}=new URL(e.url),s=t.get("origin")||"JFK",r=t.get("destination")||"SFO",a=t.get("date")||new Date().toISOString().split("T")[0],o=parseInt(t.get("passengers")||"1"),n=t.get("class")||"economy",l=g(s,r);if(!l.valid){let e=c(l.error,`Route ${s.toUpperCase()} to ${r.toUpperCase()} is not available.`);return i.NextResponse.json({success:!1,error:e},{status:400})}let u=d(a);if(!u.valid){let e=c(u.error);return i.NextResponse.json({success:!1,error:e},{status:400})}if(await new Promise(e=>setTimeout(e,500+500*Math.random())),.02>Math.random()){let e=c("SERVICE_ERROR");return i.NextResponse.json({success:!1,error:e},{status:503})}let p=m(s,r,a);if(0===p.length){let e=c("NO_FLIGHTS_FOUND",`No flights available from ${s.toUpperCase()} to ${r.toUpperCase()} on ${a}.`);return i.NextResponse.json({success:!1,error:e},{status:404})}return i.NextResponse.json({success:!0,data:{flights:p,searchParams:{origin:s.toUpperCase(),destination:r.toUpperCase(),date:a,passengers:o,class:n}}})}catch(t){console.error("Flight search error:",t);let e=c("UNKNOWN_ERROR");return i.NextResponse.json({success:!1,error:e},{status:500})}}async function R(e){try{let{origin:t,destination:s,departureDate:r,returnDate:a,passengers:o=1,class:n="economy"}=await e.json();if(!t||!s||!r){let e=c("INVALID_ROUTE","Missing required search parameters.");return i.NextResponse.json({success:!1,error:e},{status:400})}let l=g(t,s);if(!l.valid){let e=c(l.error,`Route ${t.toUpperCase()} to ${s.toUpperCase()} is not available.`);return i.NextResponse.json({success:!1,error:e},{status:400})}let u=d(r);if(!u.valid){let e=c(u.error);return i.NextResponse.json({success:!1,error:e},{status:400})}if(a){let e=d(a);if(!e.valid){let t=c(e.error,"Return date is not valid.");return i.NextResponse.json({success:!1,error:t},{status:400})}if(new Date(a)<new Date(r)){let e=c("DATE_UNAVAILABLE","Return date must be after departure date.");return i.NextResponse.json({success:!1,error:e},{status:400})}}if(o<1||o>9){let e=c("INVALID_ROUTE","Number of passengers must be between 1 and 9.");return i.NextResponse.json({success:!1,error:e},{status:400})}if(await new Promise(e=>setTimeout(e,800+700*Math.random())),.02>Math.random()){let e=c("SERVICE_ERROR");return i.NextResponse.json({success:!1,error:e},{status:503})}let p=m(t,s,r);if(0===p.length){let e=c("NO_FLIGHTS_FOUND",`No outbound flights available from ${t.toUpperCase()} to ${s.toUpperCase()} on ${r}.`);return i.NextResponse.json({success:!1,error:e},{status:404})}let h=null;if(a&&(h=m(s,t,a),0===h.length)){let e=c("NO_FLIGHTS_FOUND",`No return flights available from ${s.toUpperCase()} to ${t.toUpperCase()} on ${a}.`);return i.NextResponse.json({success:!1,error:e},{status:404})}return i.NextResponse.json({success:!0,data:{outboundFlights:p,returnFlights:h,searchParams:{origin:t.toUpperCase(),destination:s.toUpperCase(),date:r,returnDate:a,passengers:o,class:n}}})}catch(t){if(console.error("Flight search error:",t),t instanceof SyntaxError){let e=c("INVALID_ROUTE","Invalid request format.");return i.NextResponse.json({success:!1,error:e},{status:400})}let e=c("UNKNOWN_ERROR");return i.NextResponse.json({success:!1,error:e},{status:500})}}async function A(e){try{let{flightId:t,passengers:s,contactInfo:r}=await e.json();if(!t){let e=c("BOOKING_FAILED","Flight ID is required.");return i.NextResponse.json({success:!1,error:e},{status:400})}if(await new Promise(e=>setTimeout(e,1e3+1e3*Math.random())),.05>Math.random()){let e=c("BOOKING_FAILED","Unable to complete booking. The flight may no longer be available at this price.");return i.NextResponse.json({success:!1,error:e},{status:409})}let a=`SW${Date.now().toString(36).toUpperCase()}`;return i.NextResponse.json({success:!0,data:{confirmationNumber:a,status:"confirmed"}})}catch(t){console.error("Booking error:",t);let e=c("BOOKING_FAILED");return i.NextResponse.json({success:!1,error:e},{status:500})}}let U=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/flights/route",pathname:"/api/flights",filename:"route",bundlePath:"app/api/flights/route"},resolvedPagePath:"/Users/cxbilen/Documents/GitHub/skywise/app/api/flights/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:v,workUnitAsyncStorage:b,serverHooks:C}=U;function y(){return(0,n.patchFetch)({workAsyncStorage:v,workUnitAsyncStorage:b})}},6487:()=>{},8335:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,452],()=>s(1550));module.exports=r})();