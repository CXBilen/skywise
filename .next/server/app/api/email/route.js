(()=>{var e={};e.id=6,e.ids=[6],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},2503:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>g,routeModule:()=>l,serverHooks:()=>h,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>m});var i={};t.r(i),t.d(i,{GET:()=>d,POST:()=>p});var a=t(2706),s=t(8203),n=t(5994),o=t(9187);let u=[{id:"email_1",emailId:"msg_abc123",subject:"Your Delta Flight Confirmation",sender:"noreply@delta.com",receivedAt:"2025-01-15T10:30:00",extractedData:{airline:"Delta",flightNumber:"DL 1247",departureDate:"2025-02-10",departureTime:"08:00",arrivalTime:"11:15",departureAirport:"JFK",arrivalAirport:"LAX",confirmationNumber:"ABC123",passengerName:"John Doe"},confidence:{airline:"high",flightNumber:"high",date:"high",departureTime:"low",airports:"high",overall:"medium"},processed:!1},{id:"email_2",emailId:"msg_def456",subject:"United Airlines - Itinerary Confirmation",sender:"confirmation@united.com",receivedAt:"2025-01-18T14:22:00",extractedData:{airline:"United",flightNumber:"UA 892",departureDate:"2025-03-05",departureTime:"14:30",arrivalTime:"17:45",departureAirport:"SFO",arrivalAirport:"ORD",confirmationNumber:"XYZ789",passengerName:"John Doe"},confidence:{airline:"high",flightNumber:"high",date:"high",departureTime:"high",airports:"high",overall:"high"},processed:!1}];async function d(e){let{searchParams:r}=new URL(e.url),t="true"===r.get("unprocessed");await new Promise(e=>setTimeout(e,500));let i=[...u];return t&&(i=i.filter(e=>!e.processed)),o.NextResponse.json({success:!0,data:{emails:i,totalFound:i.length,lastScanned:new Date().toISOString()}})}async function p(e){try{let{action:r,emailId:t,correctedData:i}=await e.json();if(await new Promise(e=>setTimeout(e,300)),"scan"===r)return o.NextResponse.json({success:!0,data:{newFlightsFound:1,emails:u.filter(e=>!e.processed)}});if("import"===r&&t){let e=u.find(e=>e.id===t);if(!e)return o.NextResponse.json({success:!1,error:"Email not found"},{status:404});let r=i||e.extractedData,a={id:`trip_imported_${Date.now()}`,status:"draft",origin:r.departureAirport,destination:r.arrivalAirport,departureDate:`${r.departureDate}T${r.departureTime}:00`,returnDate:null,isRoundTrip:!1,totalPrice:null,currency:"USD",source:"email_import",flights:[{id:`flight_imported_${Date.now()}`,airline:r.airline,flightNumber:r.flightNumber,departureAirport:r.departureAirport,arrivalAirport:r.arrivalAirport,departureTime:`${r.departureDate}T${r.departureTime}:00`,arrivalTime:`${r.departureDate}T${r.arrivalTime}:00`,confirmationNumber:r.confirmationNumber,isOutbound:!0}],sourceEmailId:t,createdAt:new Date().toISOString()};return o.NextResponse.json({success:!0,data:{trip:a,email:{...e,processed:!0}}})}if("dismiss"===r&&t)return o.NextResponse.json({success:!0,data:{emailId:t,dismissed:!0}});return o.NextResponse.json({success:!1,error:"Invalid action"},{status:400})}catch(e){return o.NextResponse.json({success:!1,error:"Invalid request body"},{status:400})}}let l=new a.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/email/route",pathname:"/api/email",filename:"route",bundlePath:"app/api/email/route"},resolvedPagePath:"/Users/cxbilen/Documents/GitHub/skywise/app/api/email/route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:c,workUnitAsyncStorage:m,serverHooks:h}=l;function g(){return(0,n.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:m})}},6487:()=>{},8335:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[638,452],()=>t(2503));module.exports=i})();